<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shatter The Past - 2026 Reveal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-bg: rgba(255, 255, 255, 0.05);
            --neon-blue: #a8efff;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #050505;
            font-family: 'Cinzel', serif;
        }

        /* Ambient Background */
        .bg-gradient {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #1a2a3a 0%, #000000 100%);
            z-index: 0;
        }

        /* Canvas Layer */
        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 10;
            pointer-events: none; /* Let clicks pass through if needed */
        }

        /* UI Container */
        #ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 20;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease;
        }

        /* Frosted Glass Panel (Intro) */
        .glass-panel {
            width: 300px;
            height: 200px;
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5), inset 0 0 20px rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: transform 0.1s;
        }

        /* Shine effect on glass */
        .glass-panel::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shine 6s infinite linear;
            pointer-events: none;
        }

        @keyframes shine {
            0% { transform: translateX(-50%) rotate(45deg); }
            100% { transform: translateX(50%) rotate(45deg); }
        }

        h2.intro-title {
            color: rgba(255, 255, 255, 0.8);
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            letter-spacing: 4px;
            margin-bottom: 30px;
            text-transform: uppercase;
        }

        /* Break Button */
        .break-btn {
            padding: 15px 40px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.4);
            color: #fff;
            font-family: 'Cinzel', serif;
            font-size: 18px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .break-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #fff;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.8);
        }

        .break-btn:active {
            transform: scale(0.95);
        }

        /* Bottom Text Container */
        #text-container {
            position: absolute;
            bottom: 15%;
            width: 100%;
            text-align: center;
            z-index: 15;
            pointer-events: none;
        }

        .typewriter-text {
            color: rgba(255, 255, 255, 0.7);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2rem;
            letter-spacing: 3px;
            min-height: 1.5em;
            text-shadow: 0 0 10px rgba(0,0,0,0.8);
            opacity: 0; /* Hidden initially */
        }

        /* Overlay flash for explosion */
        #flash-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            opacity: 0;
            pointer-events: none;
            z-index: 100;
        }

        /* Shake Class */
        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .glass-panel { width: 80%; }
            .typewriter-text { font-size: 1rem; }
        }
    </style>
</head>
<body>

    <div class="bg-gradient"></div>
    <div id="flash-overlay"></div>
    <canvas id="mainCanvas"></canvas>

    <div id="ui-layer">
        <div class="glass-panel" id="intro-panel">
            <h2 class="intro-title">Ready for the Future?</h2>
            <button class="break-btn" id="break-btn">Break The Year</button>
        </div>
    </div>

    <div id="text-container">
        <div class="typewriter-text" id="footer-text"></div>
    </div>

<script>
    /**
     * CONFIGURATION
     */
    const CONFIG = {
        particleCountDesktop: 1800,
        particleCountMobile: 800,
        fontFamily: "'Cinzel', serif",
        colors: ['#ffffff', '#a8efff', '#70a1ff', '#dfe6e9'], // Glass/Ice tones
        text2025: "2025",
        text6: "6",
        digit5Index: 3 // The index of '5' in "2025" (0,1,2,3)
    };

    /**
     * STATE MANAGEMENT
     */
    let state = {
        width: window.innerWidth,
        height: window.innerHeight,
        isMobile: window.innerWidth < 768,
        particles: [],
        particles6: [], // Pool for the number 6
        isExploded: false,
        mouse: { x: 0, y: 0 }
    };

    // DOM Elements
    const canvas = document.getElementById('mainCanvas');
    const ctx = canvas.getContext('2d');
    const uiLayer = document.getElementById('ui-layer');
    const introPanel = document.getElementById('intro-panel');
    const breakBtn = document.getElementById('break-btn');
    const flashOverlay = document.getElementById('flash-overlay');
    const footerText = document.getElementById('footer-text');

    // Resize Handler
    function resize() {
        state.width = window.innerWidth;
        state.height = window.innerHeight;
        state.isMobile = state.width < 768;
        canvas.width = state.width;
        canvas.height = state.height;
    }
    window.addEventListener('resize', resize);
    resize();

    // Mouse Move for Parallax
    window.addEventListener('mousemove', (e) => {
        // Normalize mouse from -1 to 1
        state.mouse.x = (e.clientX / state.width) * 2 - 1;
        state.mouse.y = (e.clientY / state.height) * 2 - 1;
    });

    /**
     * PARTICLE CLASS (The Glass Shard)
     */
    class Shard {
        constructor(x, y, type = 'random') {
            this.x = x;
            this.y = y;
            this.z = Math.random() * 2; // For sizing depth
            this.originX = x;
            this.originY = y;
            
            // Destination coordinates
            this.targetX = x;
            this.targetY = y;
            
            // Physics properties
            this.vx = (Math.random() - 0.5) * 2;
            this.vy = (Math.random() - 0.5) * 2;
            this.rotation = Math.random() * Math.PI * 2;
            this.rotationSpeed = (Math.random() - 0.5) * 0.05;
            
            // Appearance
            this.size = (Math.random() * 5 + 2) * (state.isMobile ? 0.8 : 1);
            this.color = CONFIG.colors[Math.floor(Math.random() * CONFIG.colors.length)];
            this.alpha = Math.random() * 0.5 + 0.3;
            
            // Triangle shape variation
            this.p1 = { x: Math.random() * this.size, y: Math.random() * this.size };
            this.p2 = { x: Math.random() * this.size - this.size, y: Math.random() * this.size };
            this.p3 = { x: Math.random() * this.size - this.size/2, y: Math.random() * this.size - this.size };
            
            this.type = type; // 'random', 'text', 'hidden'
            this.visible = true;
        }

        draw(ctx, mouseX, mouseY) {
            if (!this.visible || this.alpha <= 0.01) return;

            // Parallax offset
            const px = this.x + (mouseX * 20 * this.z);
            const py = this.y + (mouseY * 20 * this.z);

            ctx.save();
            ctx.translate(px, py);
            ctx.rotate(this.rotation);
            ctx.globalAlpha = this.alpha;
            
            // Add slight bloom logic based on rotation (simulating reflection)
            const glint = Math.abs(Math.sin(this.rotation * 2));
            if (glint > 0.8) {
                ctx.globalCompositeOperation = 'lighter';
                ctx.globalAlpha = Math.min(1, this.alpha + 0.3);
            }

            ctx.fillStyle = this.color;
            
            ctx.beginPath();
            ctx.moveTo(this.p1.x, this.p1.y);
            ctx.lineTo(this.p2.x, this.p2.y);
            ctx.lineTo(this.p3.x, this.p3.y);
            ctx.closePath();
            ctx.fill();

            ctx.restore();
        }
    }

    /**
     * TEXT SAMPLING (Generate coordinates from font)
     */
    function getTextCoordinates(text, fontSize) {
        const offCanvas = document.createElement('canvas');
        const offCtx = offCanvas.getContext('2d');
        offCanvas.width = state.width;
        offCanvas.height = state.height;

        offCtx.font = `bold ${fontSize}px ${CONFIG.fontFamily.replace(/'/g, "")}`;
        offCtx.textAlign = 'center';
        offCtx.textBaseline = 'middle';
        offCtx.fillStyle = '#ffffff';
        
        // Draw text in center
        offCtx.fillText(text, state.width / 2, state.height / 2);

        const imageData = offCtx.getImageData(0, 0, state.width, state.height).data;
        const coordinates = [];
        
        // Scan step (optimization)
        const step = state.isMobile ? 5 : 4; 

        for (let y = 0; y < state.height; y += step) {
            for (let x = 0; x < state.width; x += step) {
                const alpha = imageData[(y * state.width + x) * 4 + 3];
                if (alpha > 128) {
                    coordinates.push({ x, y });
                }
            }
        }
        return coordinates;
    }

    /**
     * INITIALIZATION & ANIMATION LOGIC
     */

    function initParticles() {
        // Create initial random dust/shards
        const count = state.isMobile ? CONFIG.particleCountMobile : CONFIG.particleCountDesktop;
        
        for (let i = 0; i < count; i++) {
            // Start at center for explosion effect
            const x = state.width / 2 + (Math.random() - 0.5) * 10;
            const y = state.height / 2 + (Math.random() - 0.5) * 10;
            state.particles.push(new Shard(x, y, 'random'));
        }
    }

    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Update rotations
        state.particles.forEach(p => {
            p.rotation += p.rotationSpeed;
            p.draw(ctx, state.mouse.x, state.mouse.y);
        });
        
        state.particles6.forEach(p => {
            p.rotation += p.rotationSpeed;
            p.draw(ctx, state.mouse.x, state.mouse.y);
        });

        requestAnimationFrame(animate);
    }

    /**
     * THE SEQUENCE
     */

    function triggerExplosion() {
        state.isExploded = true;
        
        // 1. UI Feedback
        introPanel.classList.add('shake'); // Shake DOM
        gsap.to(flashOverlay, { opacity: 0.8, duration: 0.1, yoyo: true, repeat: 1 });
        gsap.to(uiLayer, { opacity: 0, duration: 0.5, delay: 0.1, onComplete: () => uiLayer.style.display = 'none' });

        // 2. Play Sound (Simulated via simple object approach or HTML audio if available)
        // Note: Browsers block auto audio often, assuming user clicked button so it's safer.
        
        // 3. Explode Particles Outward
        state.particles.forEach(p => {
            const angle = Math.random() * Math.PI * 2;
            const radius = Math.random() * (state.width * 0.8); // Blast radius
            
            gsap.to(p, {
                x: state.width/2 + Math.cos(angle) * radius,
                y: state.height/2 + Math.sin(angle) * radius,
                rotation: Math.random() * 10,
                duration: 1.5,
                ease: "power4.out"
            });
        });

        // 4. Trigger Formation Sequence
        setTimeout(formYear2025, 1200);
    }

    function formYear2025() {
        // Calculate font size
        const fontSize = state.isMobile ? state.width * 0.25 : state.width * 0.15;
        
        // Get coordinates for "2025"
        const coords2025 = getTextCoordinates(CONFIG.text2025, fontSize);
        
        // Shuffle coordinates to make assembly look organic
        coords2025.sort(() => Math.random() - 0.5);

        // We need to separate coords for "202" and "5"
        // Find the split point roughly. 
        // "2025" -> Since it's centered, the '5' is on the right side.
        // Let's find the Min and Max X to determine the range.
        let minX = state.width, maxX = 0;
        coords2025.forEach(c => {
            if(c.x < minX) minX = c.x;
            if(c.x > maxX) maxX = c.x;
        });
        
        // Threshold: approximate split point for the last digit (75% across the width of the text)
        const splitX = minX + (maxX - minX) * 0.75;

        const coordsMain = []; // "202"
        const coords5 = [];    // "5"

        coords2025.forEach(c => {
            if (c.x > splitX) {
                coords5.push(c);
            } else {
                coordsMain.push(c);
            }
        });

        // Assign particles
        // Reuse existing particles. If not enough, existing ones double duty or some just fade.
        let pIndex = 0;

        // Animate "202"
        coordsMain.forEach((target, i) => {
            if (pIndex < state.particles.length) {
                const p = state.particles[pIndex];
                p.type = 'main'; // Mark as part of 202
                gsap.to(p, {
                    x: target.x,
                    y: target.y,
                    rotation: 0,
                    alpha: 0.9,
                    duration: 2.5,
                    ease: "expo.inOut",
                    delay: Math.random() * 0.5
                });
                pIndex++;
            }
        });

        // Animate "5"
        coords5.forEach((target, i) => {
            if (pIndex < state.particles.length) {
                const p = state.particles[pIndex];
                p.type = 'digit5'; // Mark as part of 5
                gsap.to(p, {
                    x: target.x,
                    y: target.y,
                    rotation: 0,
                    alpha: 0.9,
                    duration: 2.5,
                    ease: "expo.inOut",
                    delay: Math.random() * 0.5
                });
                pIndex++;
            }
        });

        // Hide unused particles
        for (let i = pIndex; i < state.particles.length; i++) {
            gsap.to(state.particles[i], {
                alpha: 0,
                duration: 1
            });
        }

        // Trigger the change from 5 to 6
        setTimeout(() => transform5to6(fontSize, splitX), 4000);
    }

    function transform5to6(fontSize, splitX) {
        // 1. Break the "5"
        state.particles.forEach(p => {
            if (p.type === 'digit5') {
                gsap.to(p, {
                    y: p.y - 150 - Math.random() * 100, // Float up
                    x: p.x + (Math.random() - 0.5) * 50, // Drift
                    rotation: Math.random() * 5,
                    alpha: 0,
                    duration: 1.5,
                    ease: "power2.in"
                });
            }
        });

        // 2. Prepare "6"
        // We need to render "2026" to get the exact position of '6' relative to '202'
        // But simpler: Render "6" at the same center, then offset X coordinates to match where "5" was.
        // Better approach: Render "2026", grab coords where X > splitX.
        
        const coords2026 = getTextCoordinates("2026", fontSize);
        const coords6 = coords2026.filter(c => c.x > splitX);

        // Create specific particles for "6"
        // Start them from below
        coords6.forEach(target => {
            // Create new shards for the 6
            const p = new Shard(target.x, state.height + 100, 'digit6');
            p.alpha = 0;
            p.color = '#a8efff'; // brighter blue for the new year
            state.particles6.push(p);

            gsap.to(p, {
                x: target.x,
                y: target.y,
                alpha: 1,
                rotation: 0,
                duration: 2,
                ease: "back.out(1.2)",
                delay: 1.5 + Math.random() * 0.5 // Wait for 5 to leave
            });
        });
        
        // Final Light Sweep Effect
        setTimeout(triggerFinalEffects, 4000);
    }

    function triggerFinalEffects() {
        // 1. Text Typewriter
        const lines = ["From Birendra PalðŸ’•", "Happy New Year 2026 ðŸ’•Make Your righter Future ðŸ’•"];
        let lineIndex = 0;
        let charIndex = 0;
        
        footerText.style.opacity = 1;

        function typeLine() {
            if (lineIndex >= lines.length) return;
            
            const currentLine = lines[lineIndex];
            
            if (charIndex < currentLine.length) {
                footerText.innerHTML = currentLine.substring(0, charIndex + 1) + '<span style="border-right: 2px solid white"></span>';
                charIndex++;
                setTimeout(typeLine, 50 + Math.random() * 50);
            } else {
                // Line finished
                setTimeout(() => {
                    if (lineIndex === 0) {
                        // Fade out first line, clear, type next
                        gsap.to(footerText, { opacity: 0, duration: 0.5, onComplete: () => {
                            footerText.innerHTML = "";
                            footerText.style.opacity = 1;
                            lineIndex++;
                            charIndex = 0;
                            typeLine();
                        }});
                    }
                }, 1500);
            }
        }
        
        typeLine();

        // 2. Add a lens flare glow behind the text
        const flare = document.createElement('div');
        flare.style.position = 'absolute';
        flare.style.left = '50%';
        flare.style.top = '50%';
        flare.style.transform = 'translate(-50%, -50%) scale(0)';
        flare.style.width = '60vw';
        flare.style.height = '60vw';
        flare.style.background = 'radial-gradient(circle, rgba(168, 239, 255, 0.15) 0%, transparent 70%)';
        flare.style.pointerEvents = 'none';
        flare.style.zIndex = '5';
        document.body.appendChild(flare);
        
        gsap.to(flare, { scale: 1, duration: 2, ease: "power2.out" });
    }

    // Init Logic
    initParticles();
    animate();

    // Interaction
    breakBtn.addEventListener('click', triggerExplosion);

</script>
</body>
</html>